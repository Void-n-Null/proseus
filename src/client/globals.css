/* Fonts: Instrument Serif (display), Outfit (body) */
@import url('https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=Outfit:wght@200;300;400;500&display=swap');

@import "tailwindcss";

/* ============================================
   PROSEUS THEME — Forge-lineage dark UI
   Sister project: proseus-ai
   Same DNA, unique voice.
   ============================================ */

@theme {
  /* Surface layers — blue-tinted near-blacks, hue 250 */
  --color-background: oklch(0.2 0.007 300);
  --color-surface: oklch(0.18 0.007 300);
  --color-surface-raised: oklch(0.25 0.007 300);
  --color-surface-hover: oklch(0.23 0.007 300);
  --color-surface-sunken: oklch(0.16 0.007 300);

  /* Borders — ultra-subtle */
  --color-border: oklch(0.25 0.005 250);
  --color-border-subtle: oklch(0.20 0.005 250);

  /* Text hierarchy */
  --color-foreground: oklch(0.95 0 0);
  --color-text-body: oklch(0.88 0.005 250);
  --color-text-muted: oklch(0.50 0 0);
  --color-text-dim: oklch(0.38 0 0);

  /* Accent — cool violet, same as proseus-ai primary */
  --color-primary: oklch(0.70 0.15 280);
  --color-primary-hover: oklch(0.75 0.15 280);

  /* Destructive */
  --color-destructive: oklch(0.55 0.20 25);

  /* Font families */
  --font-display: 'Instrument Serif', Georgia, serif;
  --font-body: 'Outfit', system-ui, -apple-system, sans-serif;

  /* Sharp radius — matches forge aesthetic */
  --radius-sm: 0.125rem;
  --radius-md: 0.25rem;
  --radius-lg: 0.375rem;

  /* shadcn animation keyframes */
  --animate-in: enter 0.2s ease-out;
  --animate-out: exit 0.2s ease-in;
}

/* shadcn animation keyframes for Radix state transitions */
@keyframes enter {
  from {
    opacity: var(--tw-enter-opacity, 1);
    transform: translate3d(
        var(--tw-enter-translate-x, 0),
        var(--tw-enter-translate-y, 0),
        0
      )
      scale3d(
        var(--tw-enter-scale, 1),
        var(--tw-enter-scale, 1),
        var(--tw-enter-scale, 1)
      )
      rotate(var(--tw-enter-rotate, 0));
  }
}

@keyframes exit {
  to {
    opacity: var(--tw-exit-opacity, 1);
    transform: translate3d(
        var(--tw-exit-translate-x, 0),
        var(--tw-exit-translate-y, 0),
        0
      )
      scale3d(
        var(--tw-exit-scale, 1),
        var(--tw-exit-scale, 1),
        var(--tw-exit-scale, 1)
      )
      rotate(var(--tw-exit-rotate, 0));
  }
}

body {
  font-family: var(--font-body);
  font-weight: 300;
  background: var(--color-background);
  color: var(--color-foreground);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Minimal scrollbar */
* {
  scrollbar-width: thin;
  scrollbar-color: rgba(148, 163, 184, 0.12) transparent;
}
::-webkit-scrollbar { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(148, 163, 184, 0.12); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: rgba(148, 163, 184, 0.25); }

/* ============================================
   PILOT LIGHT — the 1px line beneath the input
   Animates between violet (idle) and
   orange→rose→violet gradient (has text).
   ============================================ */

@keyframes pilot-idle-pulse {
  0%, 100% {
    opacity: 0.25;
    box-shadow: 0 0 4px rgba(139, 92, 246, 0.15);
  }
  50% {
    opacity: 0.45;
    box-shadow: 0 0 8px rgba(139, 92, 246, 0.25);
  }
}

.pilot-light {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 1px;
  border-radius: 9999px;
}

/* Violet base — always present, fades out when gradient is active */
.pilot-violet {
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background-color: rgba(124, 58, 237, 0.25);
  box-shadow: 0 0 4px rgba(139, 92, 246, 0.15);
  animation: pilot-idle-pulse 3s ease-in-out infinite;
  transition: opacity 0.2s, background-color 0.2s, box-shadow 0.2s;
}

/* Focused idle — brighter violet */
.pilot-focused .pilot-violet {
  background-color: rgba(124, 58, 237, 0.6);
  box-shadow: 0 0 10px rgba(139, 92, 246, 0.4);
  animation: none;
}

/* Has text — hide violet layer */
.pilot-hot .pilot-violet {
  opacity: 0;
}

/* Gradient flame — orange → rose → violet */
.pilot-gradient {
  position: absolute;
  inset: 0;
  border-radius: inherit;
  background: linear-gradient(90deg, #f97316, #f43f5e, #8b5cf6);
  opacity: 0;
  box-shadow: 0 0 4px rgba(249, 115, 22, 0.15);
  transition: opacity 0.2s, box-shadow 0.2s;
}

/* Has text — show gradient */
.pilot-hot .pilot-gradient {
  opacity: 0.45;
}

/* Has text + focused — brighten */
.pilot-hot.pilot-focused .pilot-gradient {
  opacity: 0.8;
  box-shadow: 0 0 10px rgba(249, 115, 22, 0.3), 0 0 10px rgba(139, 92, 246, 0.3);
}

/* ============================================
   FLAME GLOW — drop-shadow on the SVG so the
   glow hugs the flame shape, not the button box.
   Layered orange → rose shadows for warmth.
   ============================================ */

.flame-glow svg {
  filter:
    drop-shadow(0 0 3px rgba(249, 115, 22, 0.0))
    drop-shadow(0 0 8px rgba(244, 63, 94, 0.0));
  transition: filter 0.25s ease;
}

.flame-glow:hover svg {
  filter:
    drop-shadow(0 0 4px rgba(249, 115, 22, 0.7))
    drop-shadow(0 0 10px rgba(244, 63, 94, 0.4))
    drop-shadow(0 0 18px rgba(139, 92, 246, 0.3));
}

.flame-glow:active svg {
  filter:
    drop-shadow(0 0 5px rgba(249, 115, 22, 0.9))
    drop-shadow(0 0 14px rgba(244, 63, 94, 0.6))
    drop-shadow(0 0 22px rgba(139, 92, 246, 0.4));
}

/* ============================================
   MESSAGE CONTENT — Markdown rendering styles
   Scoped to .message-content so markdown
   typography doesn't leak into UI elements.
   ============================================ */

/* Reset: marked wraps text in <p> tags. Remove default margins
   for tighter message spacing, add small gaps between blocks. */
.message-content p {
  margin: 0 0 0.5em;
}
.message-content p:last-child {
  margin-bottom: 0;
}

/* Roleplay action italics — the *action* convention.
   marked renders *text* as <em> per CommonMark. */
.message-content em {
  color: oklch(0.6 0.03 250);
  font-style: italic;
}

/* Bold */
.message-content strong {
  font-weight: 500;
  color: var(--color-foreground);
}

/* Strikethrough */
.message-content del {
  text-decoration: line-through;
  opacity: 0.6;
}

/* Inline code */
.message-content code {
  font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', monospace;
  font-size: 0.85em;
  padding: 0.15em 0.35em;
  border-radius: var(--radius-sm);
  background: oklch(0.16 0.01 250);
  color: oklch(0.82 0.08 280);
}

/* Fenced code blocks — override inline code styles */
.message-content pre {
  margin: 0.6em 0;
  padding: 0.75em 1em;
  border-radius: var(--radius-md);
  background: oklch(0.10 0.01 250);
  border: 1px solid var(--color-border-subtle);
  overflow-x: auto;
}
.message-content pre code {
  padding: 0;
  background: transparent;
  color: oklch(0.88 0.005 250);
  font-size: 0.82em;
  line-height: 1.5;
  border-radius: 0;
}

/* Blockquotes */
.message-content blockquote {
  margin: 0.5em 0;
  padding: 0.3em 0.8em;
  border-left: 3px solid oklch(0.40 0.08 280);
  color: oklch(0.70 0.01 250);
  background: oklch(0.10 0.008 250);
  border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
}
.message-content blockquote p {
  margin: 0.2em 0;
}

/* Links */
.message-content a {
  color: oklch(0.70 0.15 280);
  text-decoration: underline;
  text-underline-offset: 2px;
  text-decoration-color: oklch(0.70 0.15 280 / 0.4);
  transition: color 0.15s, text-decoration-color 0.15s;
}
.message-content a:hover {
  color: oklch(0.78 0.15 280);
  text-decoration-color: oklch(0.78 0.15 280 / 0.7);
}

/* YouTube embed cards */
.message-content .yt-embed {
  display: block;
  max-width: 360px;
  border-radius: var(--radius-md);
  overflow: hidden;
  border: 1px solid var(--color-border);
  text-decoration: none;
  transition: border-color 0.15s, box-shadow 0.15s;
  margin: 0.4em 0;
}
.message-content .yt-embed:hover {
  border-color: oklch(0.40 0.08 280);
  box-shadow: 0 2px 12px oklch(0 0 0 / 0.3);
  text-decoration: none;
}
.message-content .yt-embed-thumb {
  display: block;
  width: 360px;
  max-width: 100%;
  aspect-ratio: 16 / 9;
  background-size: cover;
  background-position: center;
  background-color: oklch(0.10 0.01 250);
  position: relative;
}
.message-content .yt-embed-play {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2.5rem;
  color: #fff;
  background: oklch(0 0 0 / 0.35);
  transition: background 0.15s;
}
.message-content .yt-embed:hover .yt-embed-play {
  background: oklch(0.35 0.18 25 / 0.85);
}
.message-content .yt-embed-title {
  display: block;
  padding: 0.35em 0.6em;
  font-size: 0.82em;
  color: var(--color-text-body);
  background: oklch(0.12 0.01 250);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Headings — rarely used in AI messages, but supported */
.message-content h1,
.message-content h2,
.message-content h3,
.message-content h4,
.message-content h5,
.message-content h6 {
  font-weight: 400;
  color: var(--color-foreground);
  margin: 0.8em 0 0.3em;
  line-height: 1.3;
}
.message-content h1 { font-size: 1.4em; }
.message-content h2 { font-size: 1.25em; }
.message-content h3 { font-size: 1.1em; }
.message-content h4,
.message-content h5,
.message-content h6 { font-size: 1em; }

/* Horizontal rules */
.message-content hr {
  border: none;
  border-top: 1px solid var(--color-border);
  margin: 0.8em 0;
}

/* Lists */
.message-content ul,
.message-content ol {
  margin: 0.4em 0;
  padding-left: 1.5em;
}
.message-content li {
  margin: 0.15em 0;
}
.message-content ul { list-style-type: disc; }
.message-content ol { list-style-type: decimal; }

/* Tables (GFM) — basic styling, not a launch blocker */
.message-content table {
  border-collapse: collapse;
  margin: 0.5em 0;
  font-size: 0.88em;
  width: 100%;
}
.message-content th,
.message-content td {
  border: 1px solid var(--color-border);
  padding: 0.35em 0.6em;
  text-align: left;
}
.message-content th {
  background: oklch(0.14 0.01 250);
  font-weight: 400;
  color: var(--color-foreground);
}
.message-content tr:nth-child(even) {
  background: oklch(0.09 0.008 250);
}

/* ============================================
   HIGHLIGHT.JS — Syntax highlighting tokens
   Scoped to .message-content pre code.
   Forge-lineage dark theme: blue-tinted neutrals
   with violet/amber/rose accents.
   ============================================ */

.message-content .hljs-keyword,
.message-content .hljs-selector-tag,
.message-content .hljs-built_in,
.message-content .hljs-name,
.message-content .hljs-tag {
  color: oklch(0.72 0.14 280);  /* violet — keywords */
}

.message-content .hljs-string,
.message-content .hljs-title,
.message-content .hljs-section,
.message-content .hljs-attribute,
.message-content .hljs-template-tag,
.message-content .hljs-template-variable,
.message-content .hljs-type {
  color: oklch(0.75 0.12 55);  /* warm amber — strings/titles */
}

.message-content .hljs-comment,
.message-content .hljs-quote,
.message-content .hljs-meta {
  color: oklch(0.45 0.01 250);  /* dim — comments */
  font-style: italic;
}

.message-content .hljs-number,
.message-content .hljs-literal,
.message-content .hljs-variable,
.message-content .hljs-regexp,
.message-content .hljs-link {
  color: oklch(0.72 0.14 25);  /* rose — numbers/literals */
}

.message-content .hljs-symbol,
.message-content .hljs-bullet,
.message-content .hljs-addition {
  color: oklch(0.72 0.15 155);  /* green — additions */
}

.message-content .hljs-deletion {
  color: oklch(0.60 0.18 25);  /* red — deletions */
}

.message-content .hljs-selector-id,
.message-content .hljs-selector-class {
  color: oklch(0.70 0.12 200);  /* teal — selectors */
}

.message-content .hljs-emphasis {
  font-style: italic;
}
.message-content .hljs-strong {
  font-weight: 500;
}

/* ============================================
   CONNECTION VALIDATION — shimmer + pulse
   Used in the Model Browser connection flow.
   ============================================ */

@keyframes connection-shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(200%); }
}

@keyframes connection-pulse {
  0%, 100% { opacity: 0.5; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.08); }
}

@keyframes connection-dots {
  0%, 20% { content: '.'; }
  40% { content: '..'; }
  60%, 100% { content: '...'; }
}

.connection-shimmer-bar {
  position: relative;
  overflow: hidden;
  border-radius: 9999px;
}

.connection-shimmer-bar::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(
    90deg,
    transparent 0%,
    oklch(0.70 0.15 280 / 0.3) 50%,
    transparent 100%
  );
  animation: connection-shimmer 1.4s ease-in-out infinite;
}

.connection-icon-pulse {
  animation: connection-pulse 1.6s ease-in-out infinite;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
